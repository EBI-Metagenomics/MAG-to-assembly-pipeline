executor {
    name              = "slurm"
    queueSize         = 200
    queueGlobalStatus = true
    submitRateLimit   = "10 sec"
    pollInterval      = "10 sec"

}

singularity {
    enabled           = true
    autoMounts        = true
    cacheDir          = "/hps/nobackup/rdf/metagenomics/service-team/singularity-cache/"
    pullTimeout       = "60 min"
}

process {
    cpus              = 1
    memory            = { check_max( 15.GB * task.attempt, 'memory' ) }
    time              = '6h'
    errorStrategy     = { task.exitStatus == 137 ? 'retry' : 'finish' }
    maxRetries        = 2
}

// withLabel:process_medium {
//         cpus   = { check_max( 6     * task.attempt, 'cpus'    ) }
//         memory = { check_max( 36.GB * task.attempt, 'memory'  ) }
//         time   = { check_max( 8.h   * task.attempt, 'time'    ) }
//     }